# Raw Data capture --> CSV

## Capture data
* To capture data you need to use the servlet: `iothttp2kafka.war`
  * The config is stored in the `web.xml`
  * This servlet pushes to MySql database the raw data.
* Before starting check that no other rta servlet is running. In case, un-deploy it

* Mysql connection
  * url: ``jdbc:mysql://c4t19765.itcs.hpecorp.net:3306/IOT_HAR``
  * user/passwd: ``root/rta-hc``

## Export to CSV
  * in ``webapps`` directory
    * are created different files (.json), result of the traffic generated by the ms band.
    * naming convention ``yyyymmddhhmmss-<sensor-name>.json``
    * The ms band2 mobile apps sends traffic every ~mn (session). All the traffic for a given session is referenced as ``yyyymmddhhmmss*.json``
  * in mysql database

    * Extract to csv query:
```
select * INTO OUTFILE '/tmp/raw_msband_current_10032016.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' LINES TERMINATED BY '\n' from RAW_MSBAND_CURRENT;
```

    * Table structure

```
    CREATE TABLE `RAW_MSBAND_CURRENT` (
  	`EVENT_ID` VARCHAR(50) NOT NULL,
  	`DEVICE_TYPE` VARCHAR(50) NOT NULL,
  	`ACTIVITY_TRAIN` VARCHAR(50) NOT NULL,
  	`DEVICE_ID` BIGINT(20) NOT NULL,
  	`TIME_STAMP_MS` BIGINT(20) NOT NULL,
  	`USER_ID` VARCHAR(50) NOT NULL,
  	`HDHLD_TYPE` VARCHAR(50) NULL DEFAULT NULL,
  	`HDHLD_CONFIDENCE` BIGINT(20) NULL DEFAULT NULL,
  	`HDHLD_LOCATION_LAT` FLOAT NULL DEFAULT NULL,
  	`HDHLD_LOCATION_LONG` FLOAT NULL DEFAULT NULL,
  	`EVENT_NAME` VARCHAR(50) NOT NULL,
  	`ACCEL_X` FLOAT NOT NULL,
  	`ACCEL_Y` FLOAT NOT NULL,
  	`ACCEL_Z` FLOAT NOT NULL,
  	`AMBLGT_BRIGHTNESS` BIGINT(20) NOT NULL,
  	`BRM_AIRPRESSURE` FLOAT NOT NULL,
  	`BRM_TEMPERATURE` FLOAT NOT NULL,
  	`GSR_RESISTANCE` BIGINT(20) NOT NULL,
  	`GYRO_X` FLOAT NOT NULL,
  	`GYRO_Y` FLOAT NOT NULL,
  	`GYRO_Z` FLOAT NOT NULL,
  	`SKTMP_TEMPERATURE` FLOAT NOT NULL,
  	`UV_INDEX` BIGINT(20) NOT NULL,
  	`HR_RATE` BIGINT(20) NOT NULL,
  	`HR_QUALITY` BIGINT(20) NOT NULL,
  	`CAL_CALORIES` BIGINT(20) NOT NULL,
  	`RRI_INTERVAL` FLOAT NOT NULL,
  	`DST_CURR_MOTION` BIGINT(20) NOT NULL,
  	`DST_PACE` FLOAT NOT NULL,
  	`DST_SPEED` FLOAT NOT NULL,
  	`DST_TOTAL_DISTANCE` BIGINT(20) NOT NULL,
  	`ALT_FLIGHTS_ASCENDED` BIGINT(20) NOT NULL,
  	`ALT_FLIGHTS_DESCENDED` BIGINT(20) NOT NULL,
  	`ALT_RATE` FLOAT NOT NULL,
  	`ALT_STEPPING_GAIN` BIGINT(20) NOT NULL,
  	`ALT_STEPPING_GAIN_LOSS` BIGINT(20) NOT NULL,
  	`ALT_STEPPING_ASCENDED` BIGINT(20) NOT NULL,
  	`ALT_STEPPING_DESCENDED` BIGINT(20) NOT NULL,
  	`ALT_TOTAL_GAIN` BIGINT(20) NOT NULL,
  	`ALT_TOTAL_LOSS` BIGINT(20) NOT NULL
  )
```
